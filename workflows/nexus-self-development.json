{
  "name": "nexus-n8n-workflow",
  "nodes": [
    {
      "parameters": {
        "updates": [
          "message"
        ]
      },
      "id": "telegram-trigger",
      "name": "Telegram Trigger",
      "type": "n8n-nodes-base.telegramTrigger",
      "typeVersion": 1.1,
      "position": [250, 300],
      "webhookId": "telegram-bot-webhook",
      "credentials": {
        "telegramApi": {
          "id": "telegram-creds",
          "name": "Telegram Bot API"
        }
      }
    },
    {
      "parameters": {
        "model": "gpt-4",
        "messages": {
          "messageValues": [
            {
              "role": "system",
              "message": "Ø£Ù†Øª NexusØŒ Ù†Ø¸Ø§Ù… Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø°Ø§ØªÙŠ Ø§Ù„ØªØ·ÙˆÙŠØ±. Ù…Ù‡Ù…ØªÙƒ ØªØ­Ù„ÙŠÙ„ Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù†ÙŠØ©:\n\n1. Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø£Ù…Ø± Ù…Ø­Ø§Ø¯Ø«Ø© Ø¹Ø§Ø¯ÙŠØ©: Ø±Ø¯ Ø¨Ù†Øµ Ø¹Ø§Ø¯ÙŠ\n2. Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø£Ù…Ø± ØªØ·ÙˆÙŠØ±ÙŠ (Ù…Ø«Ù„: Ø£Ø¶Ù Ø¹Ù‚Ø¯Ø©ØŒ Ø¹Ø¯Ù„ workflowØŒ Ø­Ø³Ù‘Ù† Ø§Ù„Ù†Ø¸Ø§Ù…): Ø±Ø¯ Ø¨Ù€ JSON Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø´ÙƒÙ„:\n{\n  \"action\": \"update_workflow\",\n  \"workflow_id\": \"workflow-id-here\",\n  \"changes\": {\n    \"nodes\": [...],\n    \"connections\": {...}\n  },\n  \"description\": \"ÙˆØµÙ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„\"\n}\n\nÙƒÙ† Ø°ÙƒÙŠØ§Ù‹ ÙÙŠ Ø§Ù„ØªÙ…ÙŠÙŠØ². Ø£ÙŠ Ø·Ù„Ø¨ ÙŠØªØ¹Ù„Ù‚ Ø¨ØªØ¹Ø¯ÙŠÙ„ Ø£Ùˆ ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù†Ø¸Ø§Ù… Ù†ÙØ³Ù‡ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† JSON."
            },
            {
              "role": "user",
              "message": "={{ $json.message.text }}"
            }
          ]
        },
        "options": {
          "temperature": 0.7
        }
      },
      "id": "nexus-ai-brain",
      "name": "Nexus AI Brain (OpenAI)",
      "type": "n8n-nodes-base.openAi",
      "typeVersion": 1.3,
      "position": [450, 300],
      "credentials": {
        "openAiApi": {
          "id": "openai-creds",
          "name": "OpenAI API"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.message }}",
              "operation": "startsWith",
              "value2": "{"
            }
          ]
        }
      },
      "id": "is-dev-command",
      "name": "Is it a Dev Command? (IF)",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [650, 300]
    },
    {
      "parameters": {
        "jsCode": "// Clean and extract pure JSON from OpenAI response\nconst response = $input.first().json.message;\n\n// Try to extract JSON if wrapped in markdown or text\nlet jsonData;\ntry {\n  // Remove markdown code blocks if present\n  let cleaned = response.replace(/```json\\n?/g, '').replace(/```\\n?/g, '');\n  \n  // Find first { and last }\n  const start = cleaned.indexOf('{');\n  const end = cleaned.lastIndexOf('}');\n  \n  if (start !== -1 && end !== -1) {\n    cleaned = cleaned.substring(start, end + 1);\n  }\n  \n  jsonData = JSON.parse(cleaned);\n} catch (error) {\n  throw new Error('Failed to parse development command: ' + error.message);\n}\n\nreturn { json: jsonData };"
      },
      "id": "code-cleaner",
      "name": "Code (Cleaner)",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [850, 200]
    },
    {
      "parameters": {
        "method": "PATCH",
        "url": "={{ $env.N8N_PROTOCOL }}://{{ $env.N8N_HOST }}:{{ $env.N8N_PORT }}/api/v1/workflows/{{ $json.workflow_id }}",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "X-N8N-API-KEY",
              "value": "={{ $env.N8N_API_KEY }}"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "nodes",
              "value": "={{ JSON.stringify($json.changes.nodes) }}"
            },
            {
              "name": "connections",
              "value": "={{ JSON.stringify($json.changes.connections) }}"
            }
          ]
        },
        "options": {}
      },
      "id": "execute-self-dev",
      "name": "Execute Self-Development (HTTP Request)",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [1050, 200]
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "âœ… ØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ø¨Ù†Ø¬Ø§Ø­!\n\nğŸ“ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„: {{ $('Code (Cleaner)').item.json.description }}\n\nğŸ”„ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¢Ù† Ù…Ø­Ø¯Ù‘Ø« ÙˆÙŠØ¹Ù…Ù„ Ø¨Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©."
      },
      "id": "send-confirmation",
      "name": "Send Confirmation (Telegram)",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.1,
      "position": [1250, 200],
      "credentials": {
        "telegramApi": {
          "id": "telegram-creds",
          "name": "Telegram Bot API"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $json.message.chat.id }}",
        "text": "={{ $('Nexus AI Brain (OpenAI)').item.json.message }}"
      },
      "id": "send-normal-reply",
      "name": "Send Normal Reply (Telegram)",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.1,
      "position": [850, 400],
      "credentials": {
        "telegramApi": {
          "id": "telegram-creds",
          "name": "Telegram Bot API"
        }
      }
    }
  ],
  "connections": {
    "Telegram Trigger": {
      "main": [
        [
          {
            "node": "Nexus AI Brain (OpenAI)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Nexus AI Brain (OpenAI)": {
      "main": [
        [
          {
            "node": "Is it a Dev Command? (IF)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Is it a Dev Command? (IF)": {
      "main": [
        [
          {
            "node": "Code (Cleaner)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send Normal Reply (Telegram)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code (Cleaner)": {
      "main": [
        [
          {
            "node": "Execute Self-Development (HTTP Request)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Execute Self-Development (HTTP Request)": {
      "main": [
        [
          {
            "node": "Send Confirmation (Telegram)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {},
  "versionId": "1",
  "id": "nexus-self-dev-workflow",
  "name": "ğŸ§  Nexus - Ø§Ù„Ù…Ø·ÙˆØ± Ø§Ù„Ø°Ø§ØªÙŠ",
  "tags": []
}
